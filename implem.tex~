
\section{Implementation}

\subsection{Platform components}
\subsection{Sequence diagrams}
\subsection{Interfaces?}
\subsubsection{Technology and tools}

In this section we will present the technology choices for each functional component stated above.
In the cloud level the functional component are the data broker, data registry and data discovery.
To cover these functionalities, The FIWARE generic enabler Orion context broker is the all-in-one solution.
It is based on the Next Generic Service Interfaces (NGSI) 9/10.
NGSI specification defines a data model and interfaces to manage the whole cycle of the virtual entities.  
We have also another candidate: the Nec IoT broker that cover the functionality of the data broker and that uses the ConfMan component for the data discovery and registry.
In the gateway level, we have these functionalities:

\begin{itemize}
    \item \emph{Multiprotocol}
The FIWARE IoT agent component: can be an option to ensure this characteristic. 
Each IoT agent can be responsible on the data transfer to and from the devices using the device specific protocol. 
    \item \emph{Device management}
We are considering the use of LwM2M device management protocol.
    \item \emph{Local rules}
FIWARE Cepheus enabler can be an option since it has a complex event processing engine. 
    \item \emph{Data processing}
this component will be developed depending on use cases requirements.
    \item \emph{Data storage}
Mongo DB can be an option, other light data bases can be also considered such as SQLiteDB.
\end{itemize}

In the devices and networking level, LoRa technology captured our attention. 
It specifies LoRaWAN for Low Power Wide Area Network (LPWAN), the kind of technology needed in our project context (rural environment). 
Using LoRaWAN we can reach above 20 km in Line-Of-Sight (LOS) condition between devices and the gateway. 

An interested tool for deploying code on the gateway level is resin.io.
It facilitate the deploy, update, and the code maintain on remote devices. 
It is based docker containers and it supports several devices (the Rpi 1, 2 and 3 are supported).

